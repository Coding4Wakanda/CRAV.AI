<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CRAV ‚Äì AI Meal Planner</title>
  <script src="https://unpkg.com/vue@3"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
  <div id="app" class="max-w-6xl mx-auto py-6 px-4 relative">

    <!-- HEADER -->
    <div class="flex justify-between items-center mb-6">
      <h1 class="text-4xl font-bold text-blue-700">ü•ë CRAV Meal Planner</h1>
      <button @click="currentPage = 'cart'" class="relative">
        üõí
        <span v-if="cart.length" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full">
          {{ cart.length }}
        </span>
      </button>
    </div>

    <!-- MENU PAGE -->
    <div v-if="currentPage === 'menu'">
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <div v-for="(item, index) in meals" :key="index" class="bg-white rounded-lg shadow p-6 hover:shadow-xl transition-shadow">
          <h2 class="text-xl font-semibold text-green-700">{{ item.name }}</h2>
          <p class="mt-2 text-sm">{{ item.description }}</p>
          <p class="mt-2 text-md font-bold text-gray-700">${{ item.price.toFixed(2) }}</p>
          <button @click="addToCart(item)" class="mt-4 bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700">
            Add to Cart
          </button>
        </div>
      </div>
    </div>

    <!-- CART PAGE -->
    <div v-if="currentPage === 'cart'" class="bg-white rounded-lg p-6 shadow max-w-2xl mx-auto">
      <h2 class="text-2xl font-bold mb-4 text-blue-700">üõí Your Cart</h2>
      <div v-if="cart.length">
        <div v-for="(item, index) in cart" :key="index" class="flex justify-between border-b py-2">
          <span>{{ item.name }}</span>
          <span>${{ item.price.toFixed(2) }}</span>
        </div>
        <div class="flex justify-between mt-4 font-semibold">
          <span>Total</span>
          <span>${{ totalPrice.toFixed(2) }}</span>
        </div>
        <button @click="checkout" class="mt-6 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
          Confirm Order
        </button>
      </div>
      <div v-else class="text-gray-500">Your cart is empty.</div>
      <button @click="currentPage = 'menu'" class="mt-6 text-blue-600 hover:underline block text-center">
        ‚Üê Back to Menu
      </button>
    </div>

    <!-- AI CHAT BUTTON -->
    <div class="fixed bottom-6 left-0 right-0 flex justify-center">
      <button @click="showChat = true" class="bg-green-600 text-white px-6 py-3 rounded-full shadow-xl hover:bg-green-700">
        üí¨ Talk to CRAV AI
      </button>
    </div>

    <!-- GPT CHAT MODAL -->
    <div v-if="showChat" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50">
      <div class="bg-white w-full max-w-lg p-6 rounded-lg shadow-lg">
        <h3 class="text-xl font-bold mb-4">üí¨ Ask CRAV AI</h3>
        <textarea v-model="userMessage" placeholder="E.g. I want a spicy vegan meal plan..." class="w-full h-24 p-2 border border-gray-300 rounded mb-4"></textarea>
        <button @click="askGPT" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
          Send
        </button>
        <p v-if="aiResponse" class="mt-4 text-sm bg-gray-100 p-2 rounded text-gray-700 whitespace-pre-wrap">{{ aiResponse }}</p>
        <button @click="showChat = false" class="mt-4 block text-blue-600 text-sm text-center hover:underline">Close</button>
      </div>
    </div>
  </div>

  <script>
    const { createApp } = Vue;
    createApp({
      data() {
        return {
          currentPage: 'menu',
          showChat: false,
          userMessage: '',
          aiResponse: '',
          cart: [],
          meals: [
            { name: "Quinoa Chickpea Bowl", description: "Protein-packed bowl with kale, hummus, and tahini drizzle.", price: 11.99 },
            { name: "Thai Peanut Noodles", description: "Rice noodles in creamy peanut sauce with bok choy and tofu.", price: 12.49 },
            { name: "Sweet Potato Buddha Bowl", description: "Roasted sweet potato, black beans, and avocado lime mash.", price: 10.99 },
            { name: "Spicy Lentil Soup", description: "Warming red lentil soup with turmeric and cumin.", price: 9.99 },
            { name: "Miso Ginger Stir-Fry", description: "Veggie-packed stir fry with miso-ginger glaze over brown rice.", price: 11.29 },
            { name: "Coconut Curry Chickpeas", description: "Chickpeas in rich coconut curry with jasmine rice.", price: 12.99 },
            { name: "Stuffed Bell Peppers", description: "Peppers filled with quinoa, spinach, and nutritional yeast.", price: 10.49 },
            { name: "Jackfruit BBQ Wrap", description: "Pulled jackfruit in tangy BBQ sauce with slaw in a wrap.", price: 11.59 },
            { name: "Tofu Scramble Bowl", description: "Savory tofu with peppers, onions, and turmeric on greens.", price: 9.49 },
            { name: "Black Bean Burrito Bowl", description: "Spiced beans with corn salsa and guac over basmati.", price: 11.89 },
            { name: "Avocado Kale Pasta", description: "Gluten-free noodles with creamy avocado pesto.", price: 13.49 },
            { name: "Chili Lime Cauliflower", description: "Roasted cauliflower bites with chili lime glaze.", price: 8.99 },
            { name: "Rainbow Veggie Tacos", description: "Beet, carrot, cabbage and tofu tacos on corn tortillas.", price: 10.29 },
            { name: "Creamy Mushroom Quinoa", description: "Quinoa with garlic mushrooms in coconut cream sauce.", price: 12.79 },
            { name: "Herbed Lentil Patties", description: "Lentil and herb patties with green tahini dip.", price: 10.99 },
            { name: "Zucchini Noodle Pad Thai", description: "Zoodles in almond butter sauce with cilantro and lime.", price: 11.19 },
            { name: "Falafel Bowl", description: "Baked falafel over tabbouleh with lemon tahini dressing.", price: 10.49 },
            { name: "Tempeh Power Plate", description: "Grilled tempeh with roasted squash and wild rice.", price: 12.39 },
            { name: "Coconut Millet Porridge", description: "Creamy coconut breakfast bowl with seeds and berries.", price: 9.29 },
            { name: "Roasted Veggie Wrap", description: "Mixed veggies with hummus in a spinach tortilla.", price: 9.99 },
            { name: "Ginger Garlic Bok Choy", description: "Bok choy saut√©ed in ginger garlic glaze with tofu.", price: 10.19 },
            { name: "Hearty Vegan Chili", description: "3-bean chili with fire-roasted tomatoes and cumin.", price: 11.29 },
            { name: "Savory Quinoa Porridge", description: "Hearty savory quinoa with spinach and mushrooms.", price: 9.59 },
            { name: "Turmeric Cauliflower Rice", description: "Low-carb rice with turmeric, peas, and herbs.", price: 8.99 },
            { name: "Alkaline Green Soup", description: "Kale, zucchini, avocado, and lime blended warm.", price: 9.79 },
            { name: "Stuffed Eggplant Boats", description: "Baked eggplant with lentil-tomato stuffing.", price: 11.69 },
            { name: "Crispy Baked Tofu Cubes", description: "Coconut-ginger marinated tofu cubes.", price: 8.79 },
            { name: "Lemon Tahini Chickpea Bowl", description: "Chickpeas, red cabbage, brown rice and tahini.", price: 10.99 },
            { name: "Detox Green Juice", description: "Cucumber, kale, ginger, lemon, and apple.", price: 6.49 },
            { name: "Date Almond Bliss Balls", description: "Snacks made with dates, oats, almond butter, cacao.", price: 7.29 }
          ]
        };
      },
      computed: {
        totalPrice() {
          return this.cart.reduce((total, item) => total + item.price, 0);
        }
      },
      methods: {
        addToCart(meal) {
          this.cart.push(meal);
        },
        checkout() {
          alert("Checkout feature coming soon!");
        },
        askGPT() {
          this.aiResponse = "Thinking...";
          fetch("https://api.openai.com/v1/chat/completions", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              "Authorization": "Bearer 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" // Replace this with your real OpenAI key
            },
            body: JSON.stringify({
              model: "gpt-4o",
              messages: [
                { role: "system", content: "You are a helpful AI meal planner." },
                { role: "user", content: this.userMessage }
              ]
            })
          })
          .then(res => res.json())
          .then(data => {
            this.aiResponse = data.choices[0].message.content;
          })
          .catch(err => {
            this.aiResponse = "Something went wrong.";
            console.error(err);
          });
        }
      }
    }).mount('#app');
  </script>
</body>
</html>
